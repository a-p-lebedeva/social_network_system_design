# TravelSocialNetwork - System Design
System Design социальной сети для путешественников, домашнее задание по [курсу System Design](https://balun.courses/courses/system_design). 
TravelSocialNetwork — это платформа для обмена идеями и впечатлениями о путешествиях.

### Функциональные требования:

- Аутентификация пользователей
- Публикация постов из путешествий с фотографиями, небольшим описанием и привязкой к конкретному месту путешествия с выбором из списка и добавлением нового места.
- Просмотр ленты других путешественников.
- Оценки и комментарии к постам других пользователей.
- Возможность подписки на других путешественников + отслеживание их активности.
- Поиск и просмотр популярных мест для путешествий + просмотр постов, связанных с этими местами.
- Только русский язык

### Нефункциональные требования:

- 10 000 000 уникальных пользователей в день
- Время ответа:
    - операции, содержащие фотографии (публикация, поиск и просмотр постов) - до 10 сек
    - операции без больших данных (добавление комментария, оценки, нового места, подписки) 1-3 сек
- Поведение пользователя:
    - публикует 2 поста в месяц, в каждый пост добавляет 6 фото, каждое не больше 1 MB, фото сжимаются с потерей качества перед сохранением в БД до 300 KB
    - просматривает ленту путешественников 1 в день, первые 3 страницы ленты
    - просматривает рейтинг мест 1 раз в неделю, первые 5 страниц рейтинга
    - просматривает посты для 3 мест в день, по 2 страницы каждого
    - по некокоторым местам читает суммарно 10 отзывов
    - просматривает комментарии к 10 отзывам, по 10 страниц комментариев
    - добавляет 3 комментария в день, максимум 50 комментариев в день
    - добавляет 3 оценки в день
    - подписывается на нового пользователя 1 раз в месяц
    - новые места добавляются редко, при расчете нагрузки можно пренебречь
- Доступность 99,95%
- Аудитория стран СНГ, сезонности нет
- Посты, фотографии, реакции, комментарии храним всегда

## Оценка нагрузки

### Расчет RPS

RPS (публикация поста): 

    10 000 000 / 15 / 86400 ~= 10

RPS (просмотр ленты): 

    10 000 000 * 3 / 86400 ~= 350

RPS (просмотр рейтинга мест): 

    10 000 000 / 30 * 4 / 86400 * 5 ~= 80

RPS (просмотр списка постов, связанных с местом): 

    10 000 000 * 6 / 86400 ~= 700

RPS (просмотр поста): 

    10 000 000 * 10 / 86400 ~= 1150

RPS (просмотр списка комментариев): 

    10 000 000 * 10 * 10 / 86400 ~= 11500

RPS (добавление комментария): 

    10 000 000 * 3 / 86400 ~= 350

RPS (добавление оценки): 

    10 000 000 * 3 / 86400 ~= 350

RPS (добавление подписки): 

    10 000 000 / 30 / 86400 ~= 5

### Расчет трафика

Публикация поста: 

    6 MB * 10 req/s ~= 60 MB/s

Просмотр ленты: 

    1,8 MB * 20 records * 350 req/s ~= 13 GB/s - очень большой трафик, будем отдавать превью 10 KB, получим:
    60 KB * 20 records * 350 req/s ~= 420 MB/s

Просмотр рейтинга мест: 

    4 KB * 20 records * 80 req/s ~= 6400 KB/s

Просмотр списка постов, связанных с местом: 

    60 KB * 20 records * 700 req/s ~= 420 MB/s
   
Просмотр поста (отдаем полные картинки): 

     1,8 MB * 1150 req/s ~= 2 GB/s

Просмотр списка комментариев: 

    4 KB * 20 records * 11500 req/s ~= 1 MB/s

Добавление комментария: 
 
    4 KB * 350 req/s ~= 1400 KB/s

Добавление оценки: 

    40 B * 350 req/s ~= 14 KB/s

Добавление подписки: 

    40 B * 5 req/s ~= 200 B/s



